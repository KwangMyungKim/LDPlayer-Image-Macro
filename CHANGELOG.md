# 변경 기록 (Changelog)

이 파일은 `LDPlayerImageMacro.ahk` (구 `AutoPlayer.ahk`) 스크립트의 주요 변경 사항 및 추가된 기능들을 기록합니다.

## 초기 버전 (2025-12-14)

### 주요 기능 추가

#### 1. 스크립트 편집 GUI 구현
- **탭 인터페이스**: '매크로' 탭과 '스크립트 편집' 탭을 분리하여 UI를 체계화했습니다.
- **스크립트 목록 뷰**: `ListView`를 통해 현재 설정된 매크로 동작 순서를 시각적으로 표시합니다.
- **동작 편집 기능**:
    - **추가**: 새로운 동작(이미지, 좌표)을 스크립트에 추가하는 기능을 구현했습니다.
    - **수정**: 기존 동작의 내용을 편집할 수 있습니다.
    - **삭제**: 불필요한 동작을 제거할 수 있습니다.
    - **순서 변경**: 스크립트의 동작 순서를 위/아래로 쉽게 조정할 수 있습니다.
- **편집 대화상자**: 스크립트 추가/수정 시, 사용자 친화적인 별도의 대화상자를 통해 상세 정보를 입력받습니다. (모달 창, 레이아웃 개선, 입력 오류 방지 적용)

#### 2. 좌표 기반 클릭 기능 추가
- **새로운 동작 타입**: 기존의 이미지 인식 방식 외에, 지정된 `X, Y` 좌표를 직접 클릭하는 '좌표(Coord)' 타입의 동작을 추가했습니다.
- **실행 로직 확장**: 매크로 실행 루프(`MacroLoop`)가 '이미지'와 '좌표' 타입을 모두 인식하고, 각 타입에 맞는 동작을 수행하도록 로직을 확장했습니다.
- **동적 편집 UI**: 스크립트 편집 대화상자에서 '이미지' 또는 '좌표' 타입을 선택하면, 해당 타입에 필요한 입력 필드(이미지 파일 vs X, Y 좌표)가 동적으로 표시됩니다.

#### 3. 이미지 검색 오차범위(Tolerance) 설정 기능
- **개별 오차범위 설정**: 각 '이미지' 타입 동작마다 `ImageSearch`의 오차범위(0~255)를 개별적으로 설정할 수 있는 기능을 추가했습니다.
- **UI 연동**:
    - 스크립트 편집 시, '이미지' 타입에 대한 오차범위를 직접 입력할 수 있습니다.
    - 스크립트 목록 뷰의 '대상' 컬럼에 `파일명 (*오차범위)` 형태로 현재 설정된 값이 표시되어 관리가 용이합니다.
- **실행 로직 반영**: 매크로 실행 시, 각 단계에 설정된 오차범위 값이 실제 이미지 검색에 동적으로 반영됩니다.


## 업데이트 (2025-12-14 추가)

### 자동 저장 및 불러오기
- **자동 저장**: 스크립트 수정 시(`macro_data.txt`) 파일에 설정을 자동으로 저장합니다.
- **자동 불러오기**: 프로그램 실행 시 저장된 설정을 자동으로 불러와 목록에 표시합니다.
- **안정성 강화**: 파일 경로를 절대 경로로 지정하고, 데이터 로드 시 공백 제거(`Trim`)를 통해 오류를 방지했습니다.

### LDPlayer 비활성 제어 및 창 선택
- **창 선택 기능**: 실행 중인 LDPlayer 창 목록을 검색하여 콤보박스(DropDownList)로 선택할 수 있습니다. (자기 자신 제외 필터링 추가)
- **비활성(Background) 제어**: `ControlClick`을 사용하여 창이 활성화되지 않거나 다른 창 뒤에 있어도(화면에 보이기만 하면) 클릭이 가능합니다.
- **하이브리드 클릭**: 대상 창이 활성화(Foreground) 상태일 때는 물리적인 `Click`을, 비활성일 때는 `ControlClick`을 사용하여 클릭 씹힘 현상을 해결했습니다.
- **이미지 중앙 클릭**: 이미지 검색 성공 시, 이미지의 중앙 좌표를 계산하여 정확하게 클릭하도록 개선했습니다.

### 선택 실행 (체크박스)
- **실행 여부 선택**: 스크립트 목록에 체크박스를 추가하여, 원하는 단계만 선택적으로 실행할 수 있습니다.
- **직관적인 UI**: 리스트 헤더에 "실행" 열을 추가하여 체크박스의 용도를 명확히 했습니다.

### 고급 흐름 제어 및 편의 기능
- **조건부 분기 (Jump)**: 스크립트 성공/실패 여부에 따라 다른 스크립트(이름 기반)로 이동할 수 있는 기능을 추가했습니다. 편집 창에서 콤보박스로 대상을 쉽게 선택할 수 있습니다.
- **스마트 웨이팅 (Timeout)**: 이미지 검색 시 타임아웃 시간을 설정하여, 이미지가 뜰 때까지 반복해서 대기하는 기능을 구현했습니다.
- **자동 최소화**: "설정" 메뉴에서 "실행 시 최소화"를 선택하면 매크로 시작 시 자동으로 창을 숨기고, 종료 시 복구합니다.
- **좌표 픽커(Picker)**: '좌표 찾기(F1)' 기능을 추가하여, 마우스로 원하는 위치를 가리키고 F1을 누르면 해당 좌표가 자동으로 입력됩니다.

### 다국어 지원 (Localization)
- **언어 설정**: 한국어(ko)와 영어(en)를 지원하며, 상단 메뉴에서 언어를 변경할 수 있습니다.
- **구조 개선**: `locales.ini` 파일을 통해 텍스트를 관리하며, UTF-8 인코딩 문제를 해결했습니다.

### 기타 개선 사항
- **GUI 개선**: 편집 대화상자의 컨트롤 겹침 문제를 해결하고, 내용이 잘리지 않도록 높이와 레이아웃을 최적화했습니다.
- **로그 개선**: 로그 줄바꿈 문자(`\r\n` -> `` `r`n ``) 및 텍스트 추가 방식(`LogEdit.Value .=`)을 개선하여 가독성을 높이고 텍스트가 진하게 보이는 현상을 수정했습니다.
- **DPI 인식**: 고해상도 모니터에서의 좌표 오차를 줄이기 위해 DPI 인식을 활성화했습니다.
- **프로그램 명칭 변경**: `AutoPlayer.ahk` -> `LDPlayerImageMacro.ahk`로 파일명을 변경하고 GUI 타이틀을 수정했습니다.
